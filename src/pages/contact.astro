---
import BaseLayout from '../layouts/BaseLayout.astro';
import { useTranslations } from '../i18n/utils';

const lang = 'de';
const t = useTranslations(lang);
---

<BaseLayout title={t('contact.title')} lang={lang} currentPath="/contact">
  <h1>{t('contact.title')}</h1>

  <div class="contact-intro">
    <p>
      Ich freue mich über Ihre Nachricht. Ob Sie Fragen zu meiner Musik haben,
      an einer Zusammenarbeit interessiert sind oder einfach Kontakt aufnehmen möchten -
      nutzen Sie gerne das folgende Formular.
    </p>
  </div>

  <form class="contact-form" id="contact-form">
    <div class="form-group">
      <label for="name">{t('contact.name')} *</label>
      <input type="text" id="name" name="name" required />
    </div>

    <div class="form-group">
      <label for="email">{t('contact.email')} *</label>
      <input type="email" id="email" name="email" required />
    </div>

    <div class="form-group">
      <label for="message">{t('contact.message')} *</label>
      <textarea id="message" name="message" rows="6" required></textarea>
    </div>

    <button type="submit" class="submit-btn">{t('contact.send')}</button>

    <div id="form-status" class="form-status"></div>
  </form>
</BaseLayout>

<style>
  h1 {
    text-align: center;
    margin-bottom: 2rem;
  }

  .contact-intro {
    max-width: 700px;
    margin: 0 auto 3rem;
    text-align: center;
    font-size: 1.1rem;
    color: #555;
  }

  .contact-form {
    max-width: 600px;
    margin: 0 auto;
  }

  .form-group {
    margin-bottom: 1.5rem;
  }

  label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 500;
    color: #333;
  }

  input,
  textarea {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-family: inherit;
    font-size: 1rem;
    transition: border-color 0.2s;
  }

  input:focus,
  textarea:focus {
    outline: none;
    border-color: #333;
  }

  textarea {
    resize: vertical;
    min-height: 120px;
  }

  .submit-btn {
    width: 100%;
    padding: 1rem;
    background: #333;
    color: white;
    border: none;
    border-radius: 4px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.2s;
  }

  .submit-btn:hover {
    background: #555;
  }

  .submit-btn:disabled {
    background: #999;
    cursor: not-allowed;
  }

  .form-status {
    margin-top: 1rem;
    padding: 1rem;
    border-radius: 4px;
    text-align: center;
    display: none;
  }

  .form-status.success {
    display: block;
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  }

  .form-status.error {
    display: block;
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  }
</style>

<script>
  const form = document.getElementById('contact-form') as HTMLFormElement;
  const statusDiv = document.getElementById('form-status') as HTMLDivElement;

  form.addEventListener('submit', async (e) => {
    e.preventDefault();

    const formData = new FormData(form);
    const data = {
      name: formData.get('name'),
      email: formData.get('email'),
      message: formData.get('message'),
    };

    const submitBtn = form.querySelector('button[type="submit"]') as HTMLButtonElement;
    submitBtn.disabled = true;
    statusDiv.className = 'form-status';
    statusDiv.style.display = 'none';

    try {
      // TODO: Replace with actual endpoint
      // For now, simulate successful submission
      await new Promise(resolve => setTimeout(resolve, 1000));

      // Simulate success
      statusDiv.className = 'form-status success';
      statusDiv.textContent = 'Nachricht erfolgreich gesendet!';
      form.reset();

      // In production, you would do:
      // const response = await fetch('/api/contact', {
      //   method: 'POST',
      //   headers: { 'Content-Type': 'application/json' },
      //   body: JSON.stringify(data),
      // });
      // if (!response.ok) throw new Error('Failed to send');

    } catch (error) {
      statusDiv.className = 'form-status error';
      statusDiv.textContent = 'Fehler beim Senden der Nachricht.';
    } finally {
      submitBtn.disabled = false;
    }
  });
</script>
